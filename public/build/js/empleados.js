let gridOptions,currentStep=1;function asignarEventos(){$(".superSearch").hide(),$(".depaSearch").hide(),document.addEventListener("keydown",a=>{"Escape"===a.key&&resetearFormularioEmpleados()}),document.getElementById("departamento_id").addEventListener("mousedown",(async function(a){a.preventDefault(),$(".depaSearch").show(),$(".inDepaSrch").focus();let e=await obtenerDepartamentosAC();await mostrarListaSearch(e,".depaSearch","departamento_id","nombre")})),document.getElementById("supervisor_id").addEventListener("mousedown",(async function(a){a.preventDefault(),$(".superSearch").show(),$(".inSuperSrch").focus();let e=await obtenerEmpleadosAC();await mostrarListaSearch(e,".superSearch","empleado_id","nombre")}))}function configurarBotones(){$(".contenedor-altas").hide(),$("#crear-empleado").click(mostrarContenedorAltas),$(".btnCancel").click(a=>{currentStep=1,resetearFormularioEmpleados()}),$(".btn-next").click((function(a){let e;a.preventDefault(),1==currentStep&&(e=validateInputs($("#empleado_formulario-personal"))),2==currentStep&&(e=validateInputs($("#empleado_formulario-contacto"))),e&&($("#paso"+currentStep).hide(),currentStep++,$("#paso"+currentStep).show(),updateActiveClass())})),$(".btn-prev").click((function(a){a.preventDefault(),$("#paso"+currentStep).hide(),currentStep--,$("#paso"+currentStep).show(),updateRemoveClass()})),$("#btnGuardar").click(a=>{validateInputs($("#empleado_formulario-laboral"))&&(""==$("#empleado_id").val()?crearUsuario():actualizarUsuario())}),updateActiveClass(),updateRemoveClass()}function inicializarPagina(){iniciarTabla("",[{headerName:"id",field:"empleado_id",width:60},{headerName:"No. Empleado",field:"num_identificacion",width:120},{headerName:"Nombre",field:"nombre",width:130},{headerName:"Apellido Paterno",field:"apellido_paterno",width:140},{headerName:"Departamento",field:"nombre_departamento",width:130},{headerName:"Estatus",field:"estado_laboral",width:100},{headerName:"Correo",field:"email",width:150},{headerName:"Teléfono Principal",field:"tel_principal",width:150},{headerName:"Estado",field:"estado",width:150},{headerName:"Fecha de Creación",field:"fecha_creacion",width:150},{headerName:"Acción",cellRenderer:function(a){const e=document.createElement("I");e.className="fa-regular fa-pen-to-square btn btn-editar",e.title="Editar",e.addEventListener("click",(async function(){await mostrarContenedorAltas(),$("#empleado_id").val(a.data.empleado_id),$("#nombre").val(a.data.nombre),$("#apellido_paterno").val(a.data.apellido_paterno),$("#apellido_materno").val(a.data.apellido_materno),$("#fecha_nacimiento").val(a.data.fecha_nacimiento),$("#sexo").val(a.data.sexo),$("#curp").val(a.data.curp),$("#rfc").val(a.data.rfc),$("#email").val(a.data.email),$("#tel_principal").val(a.data.tel_principal),$("#tel_secundario").val(a.data.tel_secundario),$("#estado").val(a.data.estado),$("#municipio").val(a.data.municipio),$("#colonia").val(a.data.colonia),$("#calle").val(a.data.calle),$("#num_exterior").val(a.data.num_exterior),$("#num_interior").val(a.data.num_interior),$("#codigo_postal").val(a.data.codigo_postal),$("#estado_laboral").val(a.data.estado_laboral),$("#num_identificacion").val(a.data.num_identificacion),$("#nivel_academico").val(a.data.nivel_academico),$("#departamento_id option").val(a.data.departamento_id),$("#departamento_id option").text(a.data.nombre_departamento),$("#supervisor_id option").val(a.data.supervisor_id),$("#supervisor_id option").text(a.data.empleado_nombre)}));const o=document.createElement("div");return o.classList="btn-cont centrado",o.appendChild(e),o},width:150,headerClass:"txt-center",cellClass:"custom-action-cell",filter:!1}],"#myGrid"),traerEmpleados()}function onQuickFilterChanged(){var a=document.getElementById("quickFilter").value;gridApi.updateGridOptions({quickFilterText:a})}function resetearFormularioEmpleados(){cerrarVentana(".contenedor-altas",["#empleado_formulario-personal","#empleado_formulario-contacto","#empleado_formulario-laboral"]),$(".altas_pasos p").removeClass("pasoActivo circle-check"),$("#paso1").show(),$("#paso2").hide(),$("#paso3").hide(),$(".paso1 p").addClass("pasoActivo"),currentStep=1}async function mostrarContenedorAltas(){$(".contenedor-altas").show(),await obtenerEmpleadosAC(),await obtenerDepartamentosAC()}async function traerEmpleados(){try{const a=await fetch("allEmpleados",{method:"GET"}),e=await a.json();let o=verificarArray(e);gridApi.setGridOption("rowData",o)}catch(a){console.error(a),SwalToast("warning","Error al obtener los usuarios",2500)}}async function obtenerEmpleadosAC(){try{const a=await fetch("empleados/activos",{method:"GET"}),e=await a.json();return!e.length>0&&SwalToast("warning","No hay Empleados disponibles.",2500),e}catch(a){console.error(a),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerDepartamentosAC(){try{const a=await fetch("departamentos/activos",{method:"GET"}),e=await a.json();return!e.length>0&&SwalToast("warning","No hay Departamentos disponibles.",2500),e}catch(a){console.error(a),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}function updateActiveClass(){$(".empleado_pasos p").removeClass("pasoActivo"),1===currentStep?$(".paso1 p").addClass("pasoActivo"):2===currentStep?($(".paso2 p").addClass("pasoActivo"),$(".paso1 p").addClass("circle-check")):3===currentStep&&($(".paso3 p").addClass("pasoActivo"),$(".paso2 p").addClass("circle-check"))}function updateRemoveClass(){$(".empleado_pasos p").removeClass("circle-check"),1===currentStep?($(".paso1 p").addClass("pasoActivo"),$(".paso2 p").removeClass("pasoActivo")):2===currentStep&&($(".paso1 p").addClass("circle-check"),$(".paso2 p").addClass("pasoActivo"),$(".paso3 p").removeClass("pasoActivo"))}function configDropZone(){Dropzone.options.testing={paramName:"file",maxFiles:1,maxFilesize:6,acceptedFiles:"image/*",init:function(){this.on("addedfile",(function(a){a.size>6291456&&this.removeFile(a),this.files.length>1&&this.removeFile(this.files[0]),a.type.startsWith("image/")||(alert("Solo se admiten imágenes"),this.removeFile(a))}))}}}async function crearUsuario(){const a=$("#nombre").val(),e=$("#apellido_paterno").val(),o=$("#apellido_materno").val(),t=$("#fecha_nacimiento").val(),r=$("#sexo").val(),n=$("#curp").val(),i=$("#rfc").val(),l=$("#email").val(),d=$("#tel_principal").val(),p=$("#tel_secundario").val(),c=$("#estado").val(),s=$("#municipio").val(),m=$("#colonia").val(),u=$("#calle").val(),v=$("#num_exterior").val(),_=$("#num_interior").val(),h=$("#codigo_postal").val(),f=$("#estado_laboral").val(),w=$("#num_identificacion").val(),S=$("#nivel_academico").val(),C=$("#supervisor_id").val(),b=$("#departamento_id").val(),E=$("#testing").val();try{const $=new FormData;$.append("nombre",a),$.append("apellido_paterno",e),$.append("apellido_materno",o),$.append("fecha_nacimiento",t),$.append("sexo",r),$.append("curp",n),$.append("rfc",i),$.append("email",l),$.append("tel_principal",d),$.append("tel_secundario",p),$.append("estado",c),$.append("municipio",s),$.append("colonia",m),$.append("calle",u),$.append("num_exterior",v),$.append("num_interior",_),$.append("codigo_postal",h),$.append("estado_laboral",f),$.append("num_identificacion",w),$.append("nivel_academico",S),$.append("supervisor_id",C),$.append("departamento_id",b),$.append("testing",E);const g=await fetch("crear/empleado",{method:"POST",body:$}),A=await g.json();console.log(A),1==A.exito?(SwalLoad("success","Éxito","Registro Creado Correctamente",!1),setTimeout(()=>{swal.close(),resetearFormularioEmpleados(),traerEmpleados()},1500)):0==A.exito&&SwalLoad("error","Error en la Transacción",A.errorSMS,!0),A.alertas&&SwalToast("warning",A.alertas.error,2500)}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function actualizarUsuario(){const a=$("#empleado_id").val(),e=$("#nombre").val(),o=$("#apellido_paterno").val(),t=$("#apellido_materno").val(),r=$("#fecha_nacimiento").val(),n=$("#sexo").val(),i=$("#curp").val(),l=$("#rfc").val(),d=$("#email").val(),p=$("#tel_principal").val(),c=$("#tel_secundario").val(),s=$("#estado").val(),m=$("#municipio").val(),u=$("#colonia").val(),v=$("#calle").val(),_=$("#num_exterior").val(),h=$("#num_interior").val(),f=$("#codigo_postal").val(),w=$("#estado_laboral").val(),S=$("#num_identificacion").val(),C=$("#nivel_academico").val(),b=$("#supervisor_id").val(),E=$("#departamento_id").val();try{const $=new FormData;$.append("empleado_id",a),$.append("nombre",e),$.append("apellido_paterno",o),$.append("apellido_materno",t),$.append("fecha_nacimiento",r),$.append("sexo",n),$.append("curp",i),$.append("rfc",l),$.append("email",d),$.append("tel_principal",p),$.append("tel_secundario",c),$.append("estado",s),$.append("municipio",m),$.append("colonia",u),$.append("calle",v),$.append("num_exterior",_),$.append("num_interior",h),$.append("codigo_postal",f),$.append("estado_laboral",w),$.append("num_identificacion",S),$.append("nivel_academico",C),$.append("supervisor_id",b),$.append("departamento_id",E);const g=await fetch("actualizar/empleado",{method:"POST",body:$}),A=await g.json();1==A.exito?(SwalLoad("success","Éxito","Registro Actualizado Correctamente",!1),setTimeout(()=>{swal.close(),resetearFormularioEmpleados(),traerEmpleados()},1500)):0==A.exito&&SwalLoad("error","Error en la Transacción",A.errorSMS,!0),A.alertas&&SwalToast("warning",A.alertas.error,2500)}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}configDropZone(),$((function(){asignarEventos(),inicializarPagina(),configurarBotones()}));
//# sourceMappingURL=empleados.js.map
