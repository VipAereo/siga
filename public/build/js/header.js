let glob,rutaServer,menu=[],bandera=0;function eventos(){const e=document.querySelector(".header_icon");let t=document.querySelector(".header_icon_info");e.addEventListener("click",()=>{t.classList.toggle("ocultar")}),document.addEventListener("click",n=>{t.contains(n.target)||e.contains(n.target)||t.classList.add("ocultar")})}async function iniciarApp(){console.log("iniciarAPp"),await obtenerDatos(),await tabs()}async function obtenerDatos(){console.log("fetch");try{const e=await fetch(location.origin+"/obtener/menu",{method:"GET"}),t=await e.json();menu=t,menu.sort((e,t)=>e.PadreId-t.PadreId),menu.sort((e,t)=>e.Nivel-t.Nivel),await crearMenuMovil(menu),await crearMenu(menu)}catch(e){console.error(e),alert("Error al obtener datos BD")}}function tabs(){document.querySelectorAll(".navigation .navigation_list li").forEach(e=>{e.addEventListener("click",(async function(e){const t=document.querySelector(".actual");if(t&&t.classList.remove("actual"),paso=parseInt(e.target.dataset.paso),paso){if(document.querySelectorAll(`[data-paso='${paso}']`)[0].classList.add("actual"),bandera==paso){$("section aside ul").empty(),$("section aside ul li").remove(),$("section article").empty();document.querySelectorAll(`[data-paso='${paso}']`)[0].classList.remove("actual"),bandera=0}else $("section aside ul li").remove(),$("section article").empty(),await mostrarAside(paso),bandera=paso}}))})}async function crearMenu(e){let t,n;for(i in rutaServer=location.origin,e)if(null==e[i].PadreId){e[i].Nombre.replace(" ","");let a="";a=e[i].Ruta?`<a href="${rutaServer+"/"+e[i].Ruta}">${e[i].Nombre}</a>`:""+e[i].Nombre,$(".navigation_list").append(`<li>${a}</li>`),document.querySelectorAll(".navigation ul li")[i].setAttribute("data-paso",e[i].MenuId),t=document.querySelector(`[data-paso="${e[0].MenuId}"]`),n=e[0].MenuId;const o=document.createElement("SECTION");o.setAttribute("data-paso-sec",e[i].MenuId);const r=document.createElement("ASIDE"),c=document.createElement("UL"),s=(document.createElement("LI"),document.createElement("ARTICLE"));s.setAttribute("data-paso-art",e[i].MenuId),o.appendChild(r),o.appendChild(s),r.appendChild(c),document.querySelector(".secciones").appendChild(o)}}function crearSubMenu(e){for(var t=0;t<e.length;t++){var n=e[t].cMenu.replace(" ","");0==t&&$("."+n).append('<ul class="subNav"></ul>'),$("."+n+" ul").append("<li   class="+n+">"+e[t].cSubMenu+"</li>")}}async function mostrarAside(e){document.querySelector(`[data-paso-sec="${e}"]`);for(i in menu)menu[i].PadreId==e&&$(`[data-paso-sec="${e}"] aside ul`).append(`<li><a data-submenu='${menu[i].MenuId}' ${menu[i].Ruta?`href='${rutaServer+"/"+menu[i].Ruta}'`:""}>${menu[i].Nombre}</a></li>`);const t=document.querySelectorAll(`[data-paso-sec="${e}"] aside ul li a`),n=document.querySelector(`[data-paso-art="${e}"]`);t.forEach(t=>{t.addEventListener("click",(function(a){$(`[data-paso-art="${e}"]`).empty();let o=parseInt(a.target.dataset.submenu);document.querySelectorAll(".asideActivo").length,t.parentNode.classList.add("asideActivo"),mostrarArticulo(n,menu,o)}))})}async function obtenerRuta(){try{const e=await fetch(location.origin+"/ruta",{method:"get"});return await e.json()}catch(e){}}function mostrarArticulo(e,t,n){document.querySelectorAll("[data-Nivel='3'] [data-Nivel] ").forEach(e=>{e.addEventListener("click",(function(t){e.classList.add("test")}))});const a=t.filter(e=>e.PadreId===n);if(a.length>0){const n=document.createElement("ul");e.appendChild(n),n.classList.add("mostrar"),a.forEach(e=>{const a=document.createElement("li");n.appendChild(a),n.setAttribute("data-Nivel",e.Nivel);const o=document.createElement("span");o.setAttribute("data-menu",e.MenuId),o.textContent=e.Nombre;let r=document.createElement("A");r.setAttribute("data-menu",e.MenuId),r.textContent=e.Nombre,e.Ruta&&(a.classList.add("conRuta"),r.setAttribute("href",e.Ruta)),r.addEventListener("click",(function(n){if(e.Ruta);else{const n=$(a).children("ul");n.length>0?n.slideToggle():mostrarArticulo(a,t,e.MenuId)}})),a.appendChild(r)})}}async function crearMenuMovil(e){const t=construirArbol(e);document.getElementById("menu").innerHTML=generateMenu(t);var n=document.querySelectorAll("#menu li"),a=document.querySelectorAll("#menu > li");a.forEach((function(e){e.addEventListener("click",(function(t){let n=e.children[0];for(var o=n.classList.contains("activa"),r=0;r<a.length;r++)a[r].children[0].classList.remove("menu-activo");o||n.classList.add("menu-activo")}))})),n.forEach((function(e){var t=e.querySelector(".parent");t.addEventListener("click",(function(n){var a=e.querySelector(".submenu");if(n.preventDefault(),a)a.style.display="block"===a.style.display?"none":"block";else{var o=t.getAttribute("href");o&&(window.location.href=o)}}))}))}function toggleMenu(){let e=document.getElementById("menu");e.classList.toggle("ocultar"),e.classList.toggle("mostrar")}function generateMenu(e,t){var n="";for(var a in e){var o=e[a],r="",c=o.submenu&&Object.keys(o.submenu).length>0;if(c){r='<ul class="submenu" data-nivel="'+(parseInt(o.Nivel)+1)+'">'+generateMenu(o.submenu)+"</ul>"}n+='<li class="menu-item'+(c?" has-submenu":"")+'"><a '+(o.Ruta?'href="'+location.origin+"/"+o.Ruta+'" ':"")+' class="parent" '+(o.Ruta?'target="_self"':"")+">"+o.Nombre+(c?'<span class="arrow-down"></span>':"")+"</a>"+r+"</li>"}return n}function construirArbol(e,t=null){const n=e.filter(e=>e.PadreId===t);if(0===n.length)return null;const a={};return n.forEach(t=>{const n=construirArbol(e,t.MenuId);n&&(t.submenu=n),a[t.MenuId]=t}),a}document.addEventListener("DOMContentLoaded",(function(){iniciarApp(),eventos()})),window.addEventListener("resize",(function(){window.innerWidth>768?(document.getElementById("menu").classList.add("ocultar"),document.querySelector(".menu").checked=!1,document.querySelector(".navigation").classList.remove("ocultar"),document.querySelector(".secciones").classList.remove("ocultar"),document.querySelector(".navigation ul").classList.remove("show")):(document.querySelector(".navigation").classList.add("ocultar"),document.querySelector(".secciones").classList.add("ocultar"))})),$(document).on("click",".menu-item a",(function(){var e=$(this).find("span.arrow-down, span.arrow-up");e.length&&e.toggleClass("arrow-down arrow-up")}));
//# sourceMappingURL=header.js.map
