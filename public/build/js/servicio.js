let gridOptions,PASAJEROS="";function asignarEventos(){$(".contenedor-altas").hide(),$(".costeo-relacion").hide(),$(".btn-pass").hide(),$("#myGrid2").addClass("event-none"),$(".pilSearch").hide(),$(".aeroSearch").hide(),$(".emprSearch").hide(),$(".cliSearch").hide(),$(".paxSearch").hide(),aplicarMascaraCantidad("subtotal","ivaNac","ivaInt","total","cant_pernocta","tot_pernocta","cant_hrs","tot_hrs"),document.addEventListener("keydown",e=>{"Escape"===e.key&&resetForm()}),document.getElementById("piloto_id").addEventListener("mousedown",(async function(e){e.preventDefault(),$(".pilSearch").show(),$(".inPilSrch").focus();let a=await obtenerPilotos();await mostrarListaSearch(a,".pilSearch","piloto_id","nombre_empleado")&&activarRutas()})),document.getElementById("pasajero_id").addEventListener("mousedown",(async function(e){e.preventDefault(),$(".paxSearch").show(),$(".inPaxSrch").focus();let a=await obtenerPasajeros();const t=await mostrarListaSearch(a,".paxSearch","pasajero_id","nombre",!0);"nuevo"==t?($("#pasajero_id option").val(),$("#pasajero_id option").text(""),nuevoPax()):($("#pasajero_id option").val(),$("#pasajero_id option").text(""),setPaxId(t))}));const e=document.querySelector(".toggle-pax"),a=document.querySelector(".toggle-pax-cont");e.addEventListener("click",(function(){a.classList.contains("expanded")?(a.classList.remove("expanded"),e.classList.remove("expanded"),$("#formPasajeros").addClass("toggle-pax-cont")):(a.classList.add("expanded"),e.classList.add("expanded"),$("#formPasajeros").removeClass("toggle-pax-cont"))}));const t=document.querySelector(".toggle-relRuta"),o=document.querySelector(".toggle-relRuta-cont");t.addEventListener("click",(async function(){o.classList.contains("expanded")?(o.classList.remove("expanded"),t.classList.remove("expanded"),$("#formRelRuta").empty()):(o.classList.add("expanded"),t.classList.add("expanded"))}));const i=document.querySelector(".toggle-relRuta");i.addEventListener("mousedown",(async function(){await relRutasPax(i)}))}function configurarBotones(){$("#btnCancel").click(e=>{resetForm()}),$("#btnPasajero").click(e=>{nuevoPax()}),$("#btnGuardar").click(async e=>{const a=validateInputs($("#formAltas")),t=$("#estatus").val();if(a&&"SVC"==t&&$("#servicio_id").val()){document.getElementById("formPasajeros").querySelectorAll(".cont-pasajero [data-pax]")?(await actualizarCotizacion(),await actualizarRutaPax()):await actualizarCotizacion()}}),$("#actTipoCambio").click(async e=>{await obtenerTipoCambio()&&SwalToast("success","Tipo de Cambio Actualizado.",2500)})}function inicializarPagina(){iniciarTabla("",[{headerName:"id",field:"servicio_id",width:80},{headerName:"Folio",field:"folio_cotizar",width:80},{headerName:"Broker",field:"nombreBrok",width:110},{headerName:"Cliente",field:"nombreCli",width:110},{headerName:"Aeronave",field:"modeloAeronave",width:160},{headerName:"Ruta",field:"concepto",width:180},{headerName:"Fecha Salida",field:"fecha_salida",width:100},{headerName:"Total",field:"total",width:120,cellStyle:{textAlign:"right"},valueFormatter:function(e){return Number(e.value).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{headerName:"Estatus",field:"estatus",width:80},{headerName:"Acción",width:150,headerClass:"txt-center",cellClass:"custom-action-cell",filter:!1,cellRenderer:function(e){const a=document.createElement("I");a.className="fa-regular fa-pen-to-square btn btn-editar",a.title="Ver o Editar",a.addEventListener("click",(async function(a){if(console.log(e.data),0==Object.keys(e.data).length)return;$("#aeronave_id").prop("disabled",!0),$("#slctOpcion").prop("disabled",!0),$("#cliente_id").prop("disabled",!0),$("#broker_id").prop("disabled",!0),$("#servicio_id").val(e.data.servicio_id),$("#cotizar_id").val(e.data.cotizar_id),$("#folio").val(e.data.folio_cotizar),$("#fecha-cot").val(formatearFecha(e.data.fecha_creacion)),$("#rt-comment").val(e.data.comentarios),$("#estatus").val(e.data.estatus),$("#aeronave_id option").val(e.data.aeronave_id),$("#aeronave_id option").text(e.data.modeloAeronave);let t=e.data.tipo_cambio,o=.01*t,i=parseFloat(t)+parseFloat(o);i.toFixed(),$("#tipo_cambio option").val(e.data.tipo_cambio_id),$("#tipo_cambio option").text(Number(i).toFixed(2)),$("#piloto_id option").val(e.data.piloto_id),$("#piloto_id option").text(e.data.nombrePiloto),await mostrarContenedorAltas(),e.data.cliente_id?($("#slctOpcion").val(1),mostrarClienteEmpresa(),$("#cliente_id option").val(e.data.cliente_id),$("#cliente_id option").text(e.data.nombreCli)):e.data.broker_id&&($("#slctOpcion").val(2),mostrarClienteEmpresa(),$("#broker_id option").val(e.data.broker_id),$("#broker_id option").text(e.data.nombreBrok),$("#rt-responsable").val(e.data.contacto_principal));let r=(await obtenerServDet(e.data.servicio_id)).map(e=>{let a={servicio_detalle_id:e.servicio_detalle_id,fecha_salida:e.fecha_salida,hora_salida:e.hora_salida,categoria:{categoria_id:e.categoria_id,nombre:e.nombreCat},concepto:e.concepto,pasajeros:e.pasajeros,tipo_vuelo:e.tipo_vuelo,cantidad:e.cantidad,percost:e.percost,tarifa:e.tarifa,subtotal:e.subtotal,rel_ruta:e.rel_ruta,relaciones_id:e.relacion_id,line_id:e.line_id};return 1==e.categoria_id&&(a.origen={aeropuerto_id:e.origenId,municipio:e.origMun},a.destino={aeropuerto_id:e.destinoId,municipio:e.destMun}),a});if(r.length<9){const e=Array(8-r.length).fill({}),a=r.concat(e).map(e=>({...e}));gridApi.setGridOption("rowData",a)}else gridApi.setGridOption("rowData",r);obtenerTarifaCosto(),botonBoardingPass(),activarRutas(),actTotales();let n=await obtenerPax(e.data.cotizar_id);detallePax=n.pasajeros;let d=n.paxDoc;for(let e=0;e<detallePax.length;e++)nuevoPax();const c=document.querySelectorAll("#formPasajeros .cont-pasajero");c.length==detallePax.length&&c.forEach((e,a)=>{const t=detallePax[a].pasajero_id,o=detallePax[a].nombre,i=e.querySelector("#paxName"+(a+1));if(i.value=o,i.dataset.pax=t,d){const a=function(e){return d[e]?Array.isArray(d[e])?d[e]:[d[e]]:[]}(t),o=e.querySelector(".contenedor-docs");a.forEach(e=>{const a=document.createElement("a");a.classList.add("thumbnail"),a.href=`/${e.ruta}/${e.hash_doc}.${e.tipo_doc}`,a.setAttribute("target","_blank");const t=document.createElement("DIV");t.classList.add("fileicon");const i=document.createElement("I");i.classList.add("fa-regular","fa-file");const r=document.createElement("DIV");r.classList.add("filename");const n=document.createElement("P");n.textContent=""+e.nombre_doc,t.appendChild(i),r.appendChild(n),a.appendChild(t),a.appendChild(r),o.appendChild(a)})}}),await ordenarPorCategoria(),$(".costeo-relacion").show()}));const t=document.createElement("div");return t.classList="btn-cont centrado",t.appendChild(a),$(".pasajeros").prop("disabled",!1),t}}],"#myGrid"),obtenerServicios()}async function configTablaCrear(){mostrarClienteEmpresa();let e=await obtenerAeropuertos(),a=await obtenerCategorias(),t=await obtenerProductos(),o=[{headerName:"Id",field:"servicio_detalle_id",width:60},{headerName:"",headerGroupComponent:CustomHeaderGroup,children:[{headerName:"Fecha",field:"fecha_salida",width:100,cellEditor:"agDateCellEditor",editable:!0,valueFormatter:function(e){let a=e.value;return a?formatearFecha(a):null},cellClassRules:{"event-none":e=>{e.data.servicio_detalle_id}}},{headerName:"Hora",field:"hora_salida",width:120,editable:!0,columnGroupShow:"open",valueFormatter:function(e){if(null!==e.value&&void 0!==e.value){const a=e.value;let t=0,o=0;if(a)if(a.includes(":")){const e=a.split(":");t=e[0],o=e[1]}else t=a;else t=a;const i=parseFloat(t),r=parseFloat(o),n=`${i.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`;return/^(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$/.test(n)?n:"00:00"}return null}}]},{headerName:"Cat",field:"categoria",width:80,cellEditor:"agSelectCellEditor",editable:!1,cellEditorParams:{values:["",...a.map(e=>({categoria_id:e.categoria_id,nombre:e.nombre}))]},valueFormatter:function(e){if(e.value)return e.value.nombre},valueGetter:function(e){return e.data.categoria?e.data.categoria.nombre:""},valueSetter:function(e){return e.data.categoria=e.newValue,!0},cellClassRules:{"event-none":e=>{const a=e.data.servicio_detalle_id;return null!=a&&""!==a}}},{headerName:"Concepto",field:"concepto",width:160,editable:!1},{headerName:"Origen",field:"origen",width:120,editable:!1,cellEditor:"agSelectCellEditor",cellEditorParams:{values:["",...e.map(e=>({aeropuerto_id:e.aeropuerto_id,municipio:e.municipio}))]},valueFormatter:function(e){if(e.value)return e.value.municipio},valueGetter:function(e){return e.data.origen?e.data.origen.municipio:""},valueSetter:function(e){return e.data.origen=e.newValue,!0}},{headerName:"Destino",field:"destino",width:120,editable:!1,cellEditor:"agSelectCellEditor",cellEditorParams:{values:["",...e.map(e=>({aeropuerto_id:e.aeropuerto_id,municipio:e.municipio}))]},valueFormatter:function(e){if(e.value)return e.value.municipio},valueParser:function(e){if(e.value)return{aeropuerto_id:e.value.aeropuerto_id,municipio:e.value.municipio}},valueGetter:function(e){return e.data.destino?e.data.destino.municipio:""},cellClassRules:{"event-none":e=>{const a=e.data.servicio_detalle_id;return null!=a&&""!==a}}},{headerName:"Pax",field:"pasajeros",width:60,editable:!0,cellEditor:"agNumberCellEditor",valueParser:function(e){return parseFloat(e.newValue)||null},valueFormatter:function(e){return null!==e.value&&void 0!==e.value?Math.round(e.value):null}},{headerName:"Tipo",field:"tipo_vuelo",width:80,cellEditor:"agSelectCellEditor",cellEditorParams:{values:["N","I"]},valueFormatter:function(e){const a=e.value;return"I"===a?"Internacional":"N"===a?"Nacional":a},editable:!1},{headerName:"",headerGroupComponent:CustomHeaderGroup,children:[{headerName:"Cant",field:"cantidad",width:80,cellEditor:"agNumberCellEditor",editable:!0,valueParser:function(e){return parseFloat(e.newValue)||null},valueFormatter:function(e){return"number"!=typeof e.value||isNaN(e.value)?null:e.value.toFixed(1)}},{headerName:"Pernocta Costo",field:"percost",width:80,cellEditor:"agNumberCellEditor",editable:!0,columnGroupShow:"open",valueParser:function(e){return"0"==e.newValue?.5:parseFloat(e.newValue)||null},valueFormatter:function(e){return"number"!=typeof e.value||isNaN(e.value)?null:e.value.toFixed(1)}}]},{headerName:"Tarifa",field:"tarifa",width:100,editable:!0,cellEditor:"agNumberCellEditor",valueFormatter:function(e){if(e.value)return Number(e.value).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")},valueSetter:function(e){return!!e.newValue&&(e.data.tarifa=e.newValue.toString(),!0)}},{headerName:"Subtotal",field:"subtotal",width:100,cellStyle:{textAlign:"right"},valueFormatter:function(e){if(e.value)return Number(e.value).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")},valueSetter:function(e){return!!e.newValue&&(e.data.subtotal=e.newValue.toString(),!0)}},{headerName:"Relacion Ruta",field:"rel_ruta",width:80},{headerName:"Relacion",field:"relaciones_id",width:80},{headerName:"LineID",field:"line_id",width:80},{headerName:"Acción",width:90,headerClass:"txt-center",cellClass:"custom-action-cell",filter:!1,cellRenderer:function(e){if("SVC"==$("#estatus").val()&&e.data.categoria&&e.data.categoria.nombre){const a=document.createElement("I");a.className="fa-regular fa-trash-can btn btn-eliminar",a.title="Eliminar",a.addEventListener("click",(async function(){if(0==Object.keys(e.data).length)return;const a=e.data.servicio_detalle_id,t=e.node;a?(await validarDetEliminar(a,t),actTotales(),actualizarCotizacion()):(limpiarCelda(t),actTotales())}));const t=document.createElement("div");return t.classList="btn-cont centrado",t.appendChild(a),t}}}];iniciarTabla("",o,"#myGrid2"),establecerAsientos(),gridApi.addEventListener("cellValueChanged",(async function(e){const a=e.column.colId,t=e.node.data,o=e.rowIndex;let i=t.origen?t.origen.aeropuerto_id:"",r=t.destino?t.destino.aeropuerto_id:"";if(("origen"==a||"destino"==a)&&i&&r){let e=await validaRutaTarifa(i,r);if("0"==e.exito){SwalToast("warning",e.alertas.error[0],2500);let a=gridApi.getRowNode(o);a&&a.data&&Object.keys(a.data).forEach(e=>{a.setDataValue(e,null)})}else{$("#costo_id").val(e.tarifa.costo_id),"N"==e.ruta.tipo_vuelo?t.tarifa=e.tarifa.costo_mx:"I"==e.ruta.tipo_vuelo&&(t.tarifa=e.tarifa.costo_usd),t.tipo_vuelo=e.ruta.tipo_vuelo,t.relaciones_id=e.ruta.ruta_id,t.rel_ruta=e.ruta.ruta_id,t.hora_salida="00:00",t.cantidad="1";let a="";"Ruta"==t.categoria.nombre&&(a=await obtenerCodigosIATA(i,r),t.concepto=a);let o=await consecutivoLineID();t.line_id=o,await generarPernoctas(),await generarAterrizajes(),await generarTUA(),await ordenarPorCategoria()}}if("fecha_salida"==a&&i&&r&&(await generarPernoctas(),await ordenarPorCategoria()),"pasajeros"==a){const a=e.newValue;e.oldValue;if(a>PASAJEROS&&(t.pasajeros=PASAJEROS,gridApi.applyTransaction({update:[t]})),t.origen&&t.destino){const e=[];gridApi.forEachNode(a=>{const t=a.data;t.categoria&&"Ruta"===t.categoria.nombre&&t.origen&&t.destino&&e.push(t)}),await generarTUA(),await ordenarPorCategoria()}}e.oldValue!=e.newValue&&t.categoria&&(t.percost||t.categoria||t.tarifa)&&(actTotalesLine(t),actTotales())})),gridApi.addEventListener("cellDoubleClicked",(async function(o){const i=o.column.colId,r=o.node.data,n=o.rowIndex,d=o.event.target;if("categoria"==i){const e=a.map(e=>({id:e.categoria_id,nombre:e.nombre}));let t=await mostrarListaGrid(d,e,"#filtro",".contenedor-altas"),o=gridApi.getRowNode(n);r.categoria&&limpiarCelda(o),o=gridApi.getRowNode(n);const i={categoria_id:t.id,nombre:t.nombre};o.setDataValue("categoria",i),gridApi.redrawRows()}if("concepto"==i&&r.categoria){if("Producto"==r.categoria.nombre){const e=t.map(e=>({id:e.producto_id,nombre:e.nombre}));let a=await mostrarListaGrid(d,e,"#filtro",".contenedor-altas"),o=await consecutivoLineID();const i=gridApi.getRowNode(n),r=t.find(e=>e.producto_id===a.id);i.setDataValue("concepto",a.nombre),i.setDataValue("relaciones_id",a.id),i.setDataValue("tarifa",r.precio),i.setDataValue("cantidad","1"),i.setDataValue("line_id",o),gridApi.redrawRows()}r.categoria.nombre,r.categoria.nombre,r.categoria.nombre}if("origen"===i||"destino"===i){const a=e.map(e=>({id:e.aeropuerto_id,nombre:e.municipio}));if(r.categoria&&"Ruta"==r.categoria.nombre&&(!r||!r.servicio_detalle_id)){let e=await mostrarListaGrid(d,a,"#filtro",".contenedor-altas");const t=gridApi.getRowNode(n),o={aeropuerto_id:e.id,municipio:e.nombre};"origen"===i?t.setDataValue("origen",o):t.setDataValue("destino",o),gridApi.redrawRows()}}}))}function limpiarCelda(e){const a=[];gridApi.forEachNode(e=>{const t=e.data;a.push(t)});a.forEach(e=>{e.colId}),e.setData({})}function actTotalesLine(e){if(!e)return;const a=e.line_id;gridApi.forEachNode(e=>{if(e.data.line_id===a&&e.data.categoria){const a=e.data.categoria.nombre,t=e.data.percost,o=e.data.cantidad,i=e.data.tarifa;let r=0;"Ruta"==a?r=o*i:"Pernocta"==a?r=o*t*i:"Aterrizaje"==a?r=i:"Producto"==a&&(r=o*i),e.setDataValue("subtotal",r)}gridApi.refreshCells({force:!0})})}function actTotales(){let e=0,a=0,t=0,o=0,i=0,r=0,n=0,d=0,c=0;gridApi.forEachNode(d=>{const c=parseFloat(d.data.cantidad||0),l=parseFloat(d.data.subtotal||0);d.data.categoria&&"Pernocta"==d.data.categoria.nombre&&(e+=c,a+=l),d.data.categoria&&"Ruta"==d.data.categoria.nombre&&(t+=c,o+=l),i+=l,"N"==d.data.tipo_vuelo?r+=l:"I"==d.data.tipo_vuelo&&(n+=l)}),d=.16*r,c=.04*n,$("#cant_pernocta").val(e),$("#tot_pernocta").val(a),$("#cant_hrs").val(t),$("#tot_hrs").val(o),$("#subtotal").val(i),$("#ivaNac").val(d),$("#ivaInt").val(c),$("#total").val(i+d+c)}async function ordenarPorCategoria(){const e=[],a=[],t=[],o=[],i=[];gridApi.forEachNode(r=>{const n=r.data;e.push(n),n.categoria&&("Ruta"==n.categoria.nombre?a.push(n):n.categoria&&"Pernocta"==n.categoria.nombre?o.push(n):n.categoria&&"Aterrizaje"==n.categoria.nombre?t.push(n):i.push(n))});let r=[...a,...o,...t,...i];if(r.push({}),r.length<9){const e=Array(8-r.length).fill({}),a=r.concat(e).map(e=>({...e}));gridApi.updateGridOptions({rowData:a})}else gridApi.updateGridOptions({rowData:r})}async function generarPernoctas(){const e=[];if(gridApi.forEachNode(a=>{let t=a.data.categoria,o=a.data.servicio_detalle_id;t&&"Pernocta"===a.data.categoria.nombre&&!o&&e.push(a.data)}),e.length>0){gridApi.applyTransaction({remove:e});const a=[];gridApi.forEachNode(e=>{const t=e.data;a.push(t)}),gridApi.updateGridOptions({rowData:a})}const a=[],t={};if(gridApi.forEachNode(e=>{const o=e.data;o.categoria&&"Ruta"===o.categoria.nombre&&o.origen&&o.destino?a.push(o):o.categoria&&"Pernocta"===o.categoria.nombre&&(t[o.rel_ruta]=o)}),a.length>1){const e=[];let o=await consecutivoLineID();for(let i=0;i<a.length-1;i++){const r=formatearFecha(a[i].fecha_salida),n=obtenerDia(r);let d=a[i].concepto;d=d.substring(d.lastIndexOf(" ")+1);const c=a[i].tarifa,l=a[i].relaciones_id,s=a[i].line_id,p=formatearFecha(a[i+1].fecha_salida),u=calcularDiferenciaDias(r,p);if(u>0)if(t[s])t[l].concepto=`${d} - Día: ${n}`,t[l].cantidad=u,t[l].subtotal=.5*u*c;else{const a={servicio_detalle_id:"",fecha_salida:r,hora_salida:"0",categoria:{categoria_id:2,nombre:"Pernocta"},concepto:`${d} - Día: ${n}`,origen:"",destino:"",pasajeros:"",tipo_vuelo:"",cantidad:u,tarifa:c,percost:"0.5",subtotal:.5*u*c,rel_ruta:s,line_id:o};o++,e.push(a)}}e.length>0&&gridApi.applyTransaction({add:e});const i=Object.values(t).filter(e=>void 0!==e.cantidad);i.length>0&&gridApi.applyTransaction({update:i})}}async function generarAterrizajes(){const e=[];if(gridApi.forEachNode(a=>{let t=a.data.categoria,o=a.data.servicio_detalle_id;t&&"Aterrizaje"===a.data.categoria.nombre&&!o&&e.push(a.data)}),e.length>0){gridApi.applyTransaction({remove:e});const a=[];gridApi.forEachNode(e=>{const t=e.data;a.push(t)}),gridApi.updateGridOptions({rowData:a})}const a=[],t={};if(gridApi.forEachNode(e=>{const o=e.data;o.categoria&&"Ruta"===o.categoria.nombre&&o.origen&&o.destino?a.push(o):o.categoria&&"Aterrizaje"===o.categoria.nombre&&(t[o.rel_ruta]=o)}),a.length>0){const e=[],o=$("#aeronave_id").val();let r=await consecutivoLineID();for(i in a)if(a[i].destino){const n=a[i].destino.aeropuerto_id;let d=a[i].concepto;d=d.substring(d.lastIndexOf(" ")+1);const c=a[i].line_id,l=formatearFecha(a[i].fecha_salida);if(!t[c]){const a=await obtenerTasaAterrizaje(n,o);if(1==a.exito){const t={servicio_detalle_id:"",fecha_salida:l,hora_salida:"0",categoria:{categoria_id:3,nombre:"Aterrizaje"},concepto:d,origen:"",destino:"",pax:"",tipo_vuelo:"",tarifa:a.aterrizaje.tarifa_aterrizaje,subtotal:a.aterrizaje.tarifa_aterrizaje,relaciones_id:a.aterrizaje.tasa_aterrizaje_id,rel_ruta:c,line_id:r,cantidad:1};r++,e.push(t)}}}e.length>0&&gridApi.applyTransaction({add:e});const n=Object.values(t).filter(e=>void 0!==e.cantidad);n.length>0&&gridApi.applyTransaction({update:n})}}async function generarTUA(){const e=[];if(gridApi.forEachNode(a=>{let t=a.data.categoria,o=a.data.servicio_detalle_id;t&&"Tua"===a.data.categoria.nombre&&!o&&e.push(a.data)}),e.length>0){gridApi.applyTransaction({remove:e});const a=[];gridApi.forEachNode(e=>{const t=e.data;a.push(t)}),gridApi.updateGridOptions({rowData:a})}const a=[],t={};gridApi.forEachNode(e=>{const o=e.data;o.categoria&&"Ruta"===o.categoria.nombre&&o.origen&&o.destino?a.push(o):o.categoria&&"Tua"===o.categoria.nombre&&(t[o.rel_ruta]=o)});const o=await obtenerTipoCambio();if(o&&a.length>0){const e=[],i=[];let r=await consecutivoLineID();const n=await obtenerAeropuertos();for(let d=0;d<a.length;d++){const c=a[d].origen.aeropuerto_id,l=a[d].pasajeros,s=a[d],p=s.line_id,u=s.concepto,m=formatearFecha(s.fecha_salida),h=n.find(e=>e.aeropuerto_id==c);if(h&&h.costo_tua){const a=parseFloat(h.costo_tua)/parseFloat(o.tipo_cambio),n=parseFloat(h.costo_tua)/parseFloat(o.tipo_cambio)*l;if(t[p])t[p].cantidad=l,t[p].tarifa=a,t[p].subtotal=n,i.push(t[p]);else if(l>0){const t={servicio_detalle_id:"",fecha_salida:m,hora_salida:"0",categoria:{categoria_id:5,nombre:"Tua"},concepto:""+u,origen:"",destino:"",pax:"",tipo_vuelo:"",cantidad:l,tarifa:a,subtotal:n,relaciones_id:h.aeropuerto_id,rel_ruta:p,line_id:r};r++,e.push(t)}}}e.length>0&&gridApi.applyTransaction({add:e}),i.length>0&&gridApi.applyTransaction({update:i})}}async function mostrarContenedorAltas(){await configTablaCrear(),$(".contenedor-altas").show()}function resetForm(){resetearTabla("#myGrid2","#searchInput1"),cerrarVentana(".contenedor-altas",["#formAltas","#formTotales"]),$("#inpCliente").hide(),$("#inpEmpresa").hide(),$("#inpGeneral").hide(),$("#aeronave_id").prop("disabled",!1),$("#slctOpcion").prop("disabled",!1),$("#cliente_id").prop("disabled",!1),$("#broker_id").prop("disabled",!1);const e=document.querySelectorAll("#formPasajeros .cont-pasajero");for(let a=0;a<e.length;a++)e[a].remove();$("#formRelRuta").empty(),PASAJEROS="",MAXPAX=0,limpiarForm("#formAltas"),obtenerServicios()}function mostrarClienteEmpresa(){let e=$("#slctOpcion").val();1==e?($("#inpCliente").show(),$("#inpEmpresa").hide(),$("label[for='cliente_id']").addClass("labelImportant"),$("label[for='broker_id']").removeClass("labelImportant"),$("select[id='broker_id'] option").val(""),$("select[id='broker_id'] option").text("")):2==e&&($("#inpCliente").hide(),$("#inpEmpresa").show(),$("label[for='broker_id']").addClass("labelImportant"),$("label[for='cliente_id']").removeClass("labelImportant"),$("select[id='cliente_id'] option").val(""),$("select[id='cliente_id'] option").text(""))}function botonBoardingPass(){$(".btn-pass").toggle(["SVC","CMP"].includes($("#estatus").val())),$("#btnServicio").toggle("CTZ"===$("#estatus").val())}function mostrarClienteEmpresa(){let e=$("#slctOpcion").val();1==e?($("#inpCliente").show(),$("#inpEmpresa").hide(),$("label[for='cliente_id']").addClass("labelImportant"),$("label[for='broker_id']").removeClass("labelImportant"),$("select[id='broker_id'] option").val(""),$("select[id='broker_id'] option").text("")):2==e&&($("#inpCliente").hide(),$("#inpEmpresa").show(),$("label[for='broker_id']").addClass("labelImportant"),$("label[for='cliente_id']").removeClass("labelImportant"),$("select[id='cliente_id'] option").val(""),$("select[id='cliente_id'] option").text(""))}function activarRutas(){let e=$("#piloto_id").val();"SVC"==$("#estatus").val()&&e?($("#myGrid2").removeClass("event-none"),$("#formTotales").removeClass("event-none"),$("#formPasajeros").removeClass("event-none")):($("#myGrid2").addClass("event-none"),$("#formTotales").addClass("event-none"),$("#formPasajeros").addClass("event-none"))}async function consecutivoLineID(){const e=[];gridApi.forEachNode(a=>e.push(a.data));let a=0;e.forEach(e=>{e.line_id&&e.line_id>a&&(a=e.line_id)});return a+1||1}function nuevoPax(){const e=document.getElementById("formPasajeros");document.getElementById("btnPasajero");let a=e.querySelectorAll(".cont-pasajero").length+1;const t=document.createElement("DIV");t.classList.add("cont-form3","cont-pasajero");const o=document.createElement("DIV");o.classList.add("form-group");const i=document.createElement("INPUT");i.type="text",i.id="pasajero_id"+a,i.classList.add("hidden");const r=document.createElement("INPUT");r.type="text",r.id="paxName"+a,r.placeholder="",o.appendChild(r);const n=document.createElement("LABEL");n.textContent="Pasajero "+a+":",n.htmlFor="paxName"+a,o.appendChild(n),t.appendChild(o);const d=document.createElement("DIV");d.classList.add("form-group");const c=document.createElement("INPUT");c.type="file",c.name="paxFile"+a,c.id="paxFile"+a,c.accept="image/*",d.appendChild(c);const l=document.createElement("A");l.id="btnEliminarPax"+a,l.classList.add("btn","btn-eliminarPax"),l.title="Eliminar Pasajero";const s=document.createElement("DIV");s.classList.add("contenedor-docs","flex"),d.appendChild(l),t.appendChild(d),e.appendChild(t),t.appendChild(s),$("#btnEliminarPax"+a).on("click",(async function(){const e=$("#cotizar_id").val(),a=$(this).closest(".cont-pasajero").find('input[id^="paxName"]').data("pax");e&&a&&await eliminarPasajero(e,a),$(this).closest(".cont-pasajero").remove()}))}async function setPaxId(e){let a=0;if(document.querySelectorAll("#formPasajeros .cont-pasajero").forEach((t,o)=>{let i=t.querySelector('input[id^="paxName"]');if(i){(i.dataset.paxn||i.dataset.pax)==e.pasajero_id&&(a=1)}}),0==a){const a=e.pasajero_id,t=await obtenerDocsbyPax(a),o=document.getElementById("formPasajeros");document.getElementById("btnPasajero"),document.getElementById("pasajero_id");let i=o.querySelectorAll(".cont-pasajero").length+1;const r=document.createElement("DIV");r.classList.add("cont-form3","cont-pasajero");const n=document.createElement("DIV");n.classList.add("form-group");const d=document.createElement("INPUT");d.type="text",d.id="pasajero_id"+i,d.classList.add("hidden");const c=document.createElement("INPUT");c.type="text",c.id="paxName"+i,c.placeholder="",c.value=e.nombre,c.setAttribute("data-paxN",a),n.appendChild(c);const l=document.createElement("LABEL");l.textContent="Pasajero "+i+":",l.htmlFor="paxName"+i,n.appendChild(l),r.appendChild(n);const s=document.createElement("DIV");s.classList.add("form-group");const p=document.createElement("INPUT");p.type="file",p.name="paxFile"+i,p.id="paxFile"+i,p.accept="image/*",s.appendChild(p);const u=document.createElement("A");u.id="btnEliminarPax"+i,u.classList.add("btn","btn-eliminarPax"),u.title="Eliminar Pasajero";const m=document.createElement("DIV");m.classList.add("contenedor-docs","flex"),s.appendChild(u),r.appendChild(s),o.appendChild(r),r.appendChild(m),t.length>0&&t.forEach(e=>{const a=document.createElement("a");a.classList.add("thumbnail"),a.href=`/${e.ruta}/${e.hash_doc}.${e.tipo_doc}`,a.setAttribute("target","_blank");const t=document.createElement("DIV");t.classList.add("fileicon");const o=document.createElement("I");o.classList.add("fa-regular","fa-file");const i=document.createElement("DIV");i.classList.add("filename");const r=document.createElement("P");r.textContent=""+e.nombre_doc,t.appendChild(o),i.appendChild(r),a.appendChild(t),a.appendChild(i),m.appendChild(a)}),$("#btnEliminarPax"+i).on("click",(async function(){$("#cotizar_id").val(),$(this).closest(".cont-pasajero").find('input[id^="paxName"]').data("paxn");$(this).closest(".cont-pasajero").remove()}))}}async function relRutasPaxPld(e,a){if(e.classList.contains("expanded"))return;let t=(await obtenerRutPaxCot($("#cotizar_id").val())).reduce((e,a)=>(e[a.ruta_id]||(e[a.ruta_id]=[]),e[a.ruta_id].push(a),e),{}),o={};gridApi.forEachNode((function(e){if(e.data.categoria&&"Ruta"==e.data.categoria.nombre){let a=document.createElement("p");a.textContent="Ruta: "+e.data.concepto,a.classList.add("rel-ruta"),a.setAttribute("data-id",e.data.line_id);let i=document.createElement("select");i.name="seleccion-"+e.data.line_id;let r=document.getElementById("formPasajeros").querySelectorAll(".cont-pasajero [data-pax]"),n=document.createElement("option");n.value="",n.textContent="Agrega un pasajero",n.disabled=!0,n.selected=!0,i.appendChild(n),r.forEach(e=>{let a=$("#"+e.id).val(),t=$("#"+e.id).data("pax"),o=document.createElement("option");o.value=a,o.textContent=a,o.setAttribute("data-pax",t),i.appendChild(o)}),i.addEventListener("change",(function(){let e=i.value,t=i.options[i.selectedIndex].getAttribute("data-pax"),r=a.getAttribute("data-id");if(o[r]||(o[r]=[]),o[r].includes(t))return console.log("¡Este pasajero ya ha sido seleccionado para esta ruta!"),void(i.value="");o[r].push(t);let n=document.createElement("p");n.textContent="Pasajero: "+e,n.setAttribute("data-paxid",t),a.insertBefore(n,i),i.value=""})),a.appendChild(i),document.getElementById("formRelRuta").appendChild(a),console.log(t),t[e.data.servicio_detalle_id]&&t[e.data.servicio_detalle_id].forEach(t=>{let r=document.createElement("p");r.textContent="Pasajero: "+t.nombre,r.setAttribute("data-paxid",t.pasajero_id),a.insertBefore(r,i);let n=Array.from(i.options).find(e=>e.getAttribute("data-pax")==t.pasajero_id);n&&(n.selected=!0),o[e.data.servicio_detalle_id]||(o[e.data.servicio_detalle_id.toString()]=[]),o[e.data.servicio_detalle_id].push(t.pasajero_id.toString())})}}))}async function relRutasPax(e,a){if(e.classList.contains("expanded"))return;let t=(await obtenerRutPaxCot($("#cotizar_id").val())).reduce((e,a)=>(e[a.ruta_id]||(e[a.ruta_id]=[]),e[a.ruta_id].push(a),e),{}),o={};gridApi.forEachNode((function(e){if(e.data.categoria&&"Ruta"===e.data.categoria.nombre){let a=document.createElement("p");a.textContent="Ruta: "+e.data.concepto,a.classList.add("rel-ruta"),a.setAttribute("data-id",e.data.line_id);let i=document.createElement("select");i.name="seleccion-"+e.data.line_id;let r=document.getElementById("formPasajeros").querySelectorAll(".cont-pasajero [data-pax]"),n=document.createElement("option");n.value="",n.textContent="Agrega un pasajero",n.disabled=!0,n.selected=!0,i.appendChild(n),r.forEach(e=>{let a=e.value,t=e.getAttribute("data-pax"),o=document.createElement("option");o.value=t,o.textContent=a,i.appendChild(o)}),i.addEventListener("change",(function(){let e=i.value,t=i.options[i.selectedIndex].textContent,r=a.getAttribute("data-id");if(o[r]||(o[r]=[]),o[r].includes(e))return console.log("¡Este pasajero ya ha sido seleccionado para esta ruta!"),void(i.value="");o[r].push(e);let n=document.createElement("p");n.textContent="Pasajero: "+t,n.setAttribute("data-paxid",e),a.insertBefore(n,i),i.value=""})),a.appendChild(i),document.getElementById("formRelRuta").appendChild(a),t[e.data.line_id]&&t[e.data.line_id].forEach(t=>{let r=document.createElement("p");r.textContent="Pasajero: "+t.nombre,r.setAttribute("data-paxid",t.pasajero_id),a.insertBefore(r,i),o[e.data.line_id]||(o[e.data.line_id]=[]),o[e.data.line_id].push(t.pasajero_id.toString())})}}))}async function obtenerRutPaxCot(e){try{const a=new FormData;a.append("cotizar_id",e);const t=await fetch("../obtener/rutPaxCot",{method:"POST",body:a});return await t.json()}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function validarGrid(){let e=[];try{const a=[];gridApi.forEachNode(e=>a.push(e));for(const t of a){const a=t.data.relaciones_id,o=t.data.categoria,i=t.data.concepto,r=t.data.fecha_salida,n=t.data.cantidad;let d={};if(a){if(d={...t.data},d.categoria&&void 0!==d.categoria.categoria_id&&(d.categoria=d.categoria.categoria_id),o&&"Ruta"==o.nombre){if(null==r)throw SwalToast("warning","Fecha Obligatoria",2500);if(null==n)throw SwalToast("warning","Horas Obligatorias",2500);const e=formatearFechaYear(r);d.origen&&void 0!==d.origen.aeropuerto_id&&(d.origen=d.origen.aeropuerto_id),d.destino&&void 0!==d.destino.aeropuerto_id&&(d.destino=d.destino.aeropuerto_id);const a=await formatoHora(d.hora_salida);d.hora_salida=a,d.fecha_salida=e}e.push(d)}else if(o&&"Pernocta"==o.nombre){if(null==i)throw SwalToast("warning","Concepto Obligatorio para Pernocta",2500);d={...t.data},d.categoria&&void 0!==d.categoria.categoria_id&&(d.categoria=d.categoria.categoria_id),e.push(d)}}}catch(e){return""}return e}async function validarPasajeros(){const e=[];return document.querySelectorAll("#formPasajeros .cont-pasajero").forEach((a,t)=>{let o=a.querySelector('input[id^="paxName"]'),i=a.querySelector('input[id^="paxFile"]'),r={};if(o&&""!==o.value.trim()||o&&o.dataset.paxn){let a=o.dataset.pax||o.dataset.paxn;a&&(r.pasajero_id=a.trim()),i&&i.files.length>0&&(r.nombre_ruta=i.files[0]),r.nombre=o.value.trim(),e.push(r)}}),e}async function validarRutaPax(){const e=[];return $("#formRelRuta").find("p[data-id]").each((function(){const a=$(this).attr("data-id");$(this).find("p[data-paxid]").each((function(){const t=$(this).attr("data-paxid");a&&t&&e.push({ruta_id:a,pasajero_id:t})}))})),e}async function obtenerServicios(){try{const e=await fetch("../obtener/servicios",{method:"GET"}),a=await e.json();let t=verificarArray(a);gridApi.setGridOption("rowData",t)}catch(e){console.error(e),SwalToast("warning","Error al obtener las cotizaciones",2500)}}async function obtenerServDet(e){try{const a=new FormData;a.append("servicio_id",e);const t=await fetch("../obtener/vuelosServ",{method:"POST",body:a});return await t.json()}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerAeropuertos(){try{const e=await fetch("../allAeropuertos",{method:"GET"}),a=await e.json();return!a.length>0?SwalToast("warning","No hay Aeropuertos disponibles.",2500):AEROPUERTOS=a,a}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerTarifaCosto(){try{const e=$("#aeronave_id").val(),a=$("#broker_id").val(),t=$("#cliente_id").val(),o=new FormData;o.append("aeronave",e),o.append("broker_id",a),o.append("cliente_id",t);const i=await fetch("../obtener/tarifacostos",{method:"post",body:o}),r=await i.json();r&&r.tarifa&&$("#costo_id").val(r.tarifa.costo_id)}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerCategorias(){try{const e=await fetch("../obtener/categorias",{method:"GET"}),a=await e.json();return!a.length>0&&SwalToast("warning","No hay Categorias disponibles.",2500),a}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerProductos(){try{const e=await fetch("../obtener/productos",{method:"GET"}),a=await e.json();return!a.length>0&&SwalToast("warning","No hay Productos disponibles.",2500),a}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerPilotos(){try{const e=await fetch("pilotos/activos",{method:"GET"}),a=await e.json();return!a.length>0&&SwalToast("warning","No hay Pilotos disponibles.",2500),a}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerPasajeros(){try{const e=await fetch("../obtener/pasajeros",{method:"get"});return await e.json()}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerCodigosIATA(e,a){try{const t=new FormData;t.append("origen",e),t.append("destino",a);const o=await fetch("../obtener/codigos",{method:"POST",body:t});return await o.json()}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerTasaAterrizaje(e,a){try{const t=new FormData;t.append("origen",e),t.append("aeronave_id",a);const o=await fetch("../valida/aterrizaje",{method:"POST",body:t});return await o.json()}catch(e){console.error(e),SwalToast("warning","Error al obtener los usuarios",2500)}}async function obtenerDocsbyPax(e){try{const a=new FormData;a.append("pasajero_id",e);const t=await fetch("../obtener/pasajerosDocs",{method:"POST",body:a});return await t.json()}catch(e){console.error(e),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function obtenerAeronaves(){try{const e=await fetch("../allAeronaves",{method:"GET"}),a=await e.json();return!a.length>0&&SwalToast("warning","No hay Aeronaves disponibles.",2500),a}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerPax(e){try{const a=new FormData;a.append("cotizar_id",e);const t=await fetch("../obtener/pax",{method:"POST",body:a});return await t.json()}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function validaRutaTarifa(e,a){try{let t=$("#cliente_id").val(),o=$("#broker_id").val();const i=$("#aeronave_id").val(),r=new FormData;r.append("origen",e),r.append("destino",a),r.append("cliente_id",t),r.append("broker_id",o),r.append("aeronave_id",i);const n=await fetch("../valida/ruta",{method:"POST",body:r});return await n.json()}catch(e){console.error(e),SwalToast("warning","Error al obtener los usuarios",2500)}}async function establecerAsientos(){let e=await obtenerAeronaves(),a=$("#aeronave_id").val();const t=e.find(e=>e.aeronave_id==a);t&&(PASAJEROS=t.asientos)}async function obtenerTipoCambio(){try{const e=await fetch("../tipo/cambio",{method:"GET"}),a=await e.json();if(a){let e=a.tipo_cambio,t=.01*e,o=parseFloat(e)+parseFloat(t);$("#tipo_cambio option").val(a.tipo_cambio_id),$("#tipo_cambio option").text(parseFloat(o).toFixed(2))}else SwalToast("warning","No hay Tipo de Cambio.",2500);return a}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function validarDetEliminar(e,a){if("Ruta"===a.data.categoria.nombre){$("#aeronave_id").val();gridApi.forEachNode(async a=>{const t=a.data,o=a;t.categoria&&"Pernocta"===t.categoria.nombre&&t.rel_ruta===e&&(limpiarCelda(o),await eliminarDet(t.servicio_detalle_id)),t.categoria&&"Tua"===t.categoria.nombre&&t.rel_ruta===e&&(limpiarCelda(o),await eliminarDet(t.servicio_detalle_id)),t.categoria&&"Aterrizaje"===t.categoria.nombre&&t.rel_ruta===e&&(limpiarCelda(o),await eliminarDet(t.servicio_detalle_id))})}await eliminarDet(a.data.servicio_detalle_id),limpiarCelda(a)}async function actualizarCotizacion(){try{const e=new FormData,a=$("#servicio_id").val(),t=$("#piloto_id").val(),o=$("#folio").val(),i=$("#estatus").val(),r=$("#fecha-cot").val(),n=$("#aeronave_id").val();if(1==$("#slctOpcion").val()){const a=$("#cliente_id").val();e.append("cliente_id",a)}else if(2==$("#slctOpcion").val()){const a=$("#broker_id").val();e.append("broker_id",a)}const d=$("#tipo_cambio").val(),c=$("#cant_pernocta").val(),l=sinComa($("#tot_pernocta").val()),s=sinComa($("#tot_hrs").val()),p=sinComa($("#subtotal").val()),u=sinComa($("#ivaNac").val()),m=sinComa($("#ivaInt").val()),h=sinComa($("#total").val()),f=$("#costo_id").val(),g=$("#rt-comment").val();let _=0,v=await validarGrid(),b=await validarPasajeros();if(v.length>0){let w=v[0].origen,E=v[0].destino;if(1==v.length)_=1;else if(2==v.length){let e=v[1].origen;_=w==v[1].destino&&E==e?2:3}else _=3;e.append("servicio_id",a),e.append("piloto_id",t),e.append("folio_cotizar",o),e.append("aeronave_id",n),e.append("fecha_creacion",r),e.append("estatus",i),e.append("tipo_cambio_id",d),e.append("cant_pernocta",c),e.append("tot_pernocta",l),e.append("tot_hr_cotizadas",s),e.append("subtotal",p),e.append("ivaNac",u),e.append("ivaInt",m),e.append("total",h),e.append("comentarios",g),e.append("tipo_de_viaje",_),e.append("costo_id",f),e.append("pasajerosDet",JSON.stringify(b)),e.append("detalles",JSON.stringify(v)),b.forEach((a,t)=>{if(a&&a.nombre&&a.nombre_ruta){let t;a.pasajero_id?(t=a.pasajero_id,e.append("archivo_"+t,a.nombre_ruta)):(t=a.nombre.split(" ").map(e=>e.charAt(0)).join(""),e.append("archivo_"+t,a.nombre_ruta))}});const C=await fetch("../actualizar/servicio",{method:"POST",body:e}),x=await C.json();if(1==x.exito?(SwalLoad("success","Éxito","Registro Actualizado Correctamente",!1),setTimeout(()=>{swal.close(),resetForm(),obtenerServicios()},1500)):0==x.exito&&SwalLoad("error","Error en la Transacción",x.errorSMS,!0),x.alertas)return void SwalToast("warning",x.alertas.error,2500)}}catch(e){console.error(e),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function actualizarRutaPax(){try{let e=await validarRutaPax();if(""==e)return;const a=$("#cotizar_id").val(),t=document.querySelector('meta[name="csrf-token"]').getAttribute("content"),o=new FormData;o.append("id_cot",a),o.append("relRutaPax",JSON.stringify(e)),o.append("csrf_token",t);const i=await fetch("../actualizar/relacionRutaPax",{method:"POST",body:o,headers:{"X-CSRF-Token":t}}),r=await i.json();console.log(r),$("#formRelRuta").empty()}catch(e){console.error(e),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function eliminarPasajero(e,a){try{const t=new FormData;t.append("cotizar_id",e),t.append("pasajero_id",a);const o=await fetch("../eliminar/pasajero",{method:"POST",body:t}),i=await o.json();if(1==i.exito&&SwalToast("success","Registro Eliminado Correctamente",2500),i.alertas)return void SwalToast("warning",i.alertas.error,2500)}catch(e){console.error(e),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function eliminarDet(e){try{const a=$("#servicio_id").val(),t=new FormData;t.append("servicio_detalle_id",e),t.append("servicio_id",a);const o=await fetch("../eliminar/detServicio",{method:"POST",body:t}),i=await o.json();if(i.exito,i.alertas)return void SwalToast("warning",i.alertas.error,2500)}catch(e){console.error(e),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}$((function(){asignarEventos(),inicializarPagina(),configurarBotones()}));class CustomHeaderGroup{init(e){this.params=e,this.eGui=document.createElement("div"),this.eGui.className="ag-header-group-cell-label",this.eGui.innerHTML='<div class="customHeaderLabel">'+this.params.displayName+'</div><div class="customExpandButton"><i class="fa fa-arrow-right"></i></div>',this.onExpandButtonClickedListener=this.expandOrCollapse.bind(this),this.eExpandButton=this.eGui.querySelector(".customExpandButton"),this.eExpandButton.addEventListener("click",this.onExpandButtonClickedListener),this.onExpandChangedListener=this.syncExpandButtons.bind(this),this.params.columnGroup.getProvidedColumnGroup().addEventListener("expandedChanged",this.onExpandChangedListener),this.syncExpandButtons()}getGui(){return this.eGui}expandOrCollapse(){var e=this.params.columnGroup.getProvidedColumnGroup().isExpanded();this.params.setExpanded(!e)}syncExpandButtons(){var e,a;this.params.columnGroup.getProvidedColumnGroup().isExpanded()?(a=this.eExpandButton).className=a.className.split(" ")[0]+" expanded":(e=this.eExpandButton).className=e.className.split(" ")[0]+" collapsed"}destroy(){this.eExpandButton.removeEventListener("click",this.onExpandButtonClickedListener)}}
//# sourceMappingURL=servicio.js.map
