let gridOptions;function asignarEventos(){$(".aeronSearch").hide(),$(".prefSearch").hide(),document.addEventListener("keydown",a=>{"Escape"===a.key&&resetForm()}),aplicarMascaraCantidad("costo_mx","costo_usd"),document.getElementById("aeronave_id").addEventListener("mousedown",(async function(a){a.preventDefault(),$(".aeronSearch").show(),$(".inAeronSrch").focus();let e=await obtenerAeronaves();await mostrarListaSearch(e,".aeronSearch","aeronave_id","modelo")})),document.getElementById("preferencia_id").addEventListener("mousedown",(async function(a){a.preventDefault(),$(".prefSearch").show(),$(".inPrefSrch").focus();let e=await obtenerPreferencia();await mostrarListaSearch(e,".prefSearch","tipo_id","nombre")}))}function configurarBotones(){$(".contenedor-altas").hide(),$("#crear-tarifa").click(mostrarContenedorAltas),$(".btn-cancelar").click(a=>{resetForm()}),$("#btnGuardar").click(a=>{validateInputs($("#formAltas"))&&(""==$("#costo_id").val()?crearTarifa():actualizarTarifa())})}function inicializarPagina(){iniciarTabla("",[{headerName:"id",field:"costo_id",width:80},{headerName:"Aeronave",field:"modelo",width:150},{headerName:"Preferencia",field:"tipo_nombre",width:130},{headerName:"Costo Nacional",field:"costo_mx",width:120,cellStyle:{textAlign:"right"},valueFormatter:function(a){return Number(a.value).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{headerName:"Costo Internacional",field:"costo_usd",width:120,cellStyle:{textAlign:"right"},valueFormatter:function(a){return Number(a.value).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{headerName:"Fecha Creación",field:"fecha_creacion",width:130},{headerName:"Acción",cellRenderer:function(a){const e=document.createElement("I");e.className="fa-regular fa-pen-to-square btn btn-editar",e.title="Editar",e.addEventListener("click",(async function(){await mostrarContenedorAltas(),$("#costo_id").val(a.data.costo_id),$("#preferencia").val(a.data.preferencia),$("#costo_mx").val(a.data.costo_mx),$("#costo_usd").val(a.data.costo_usd),$("#aeronave_id option").val(a.data.aeronave_id),$("#aeronave_id option").text(a.data.modelo),$("#aeronave_id").addClass("input-disabled"),$("#costo_mx").addClass("input-disabled"),$("#costo_usd").addClass("input-disabled"),$("#preferencia_id option").val(a.data.tarifa_id),$("#preferencia_id option").text(a.data.tipo_nombre)}));const r=document.createElement("div");return r.classList="btn-cont centrado",r.appendChild(e),r},width:150,headerClass:"txt-center",cellClass:"custom-action-cell",filter:!1}],"#myGrid"),traerTarifas()}function resetForm(){cerrarVentana(".contenedor-altas",["#formAltas"])}async function mostrarContenedorAltas(){$(".contenedor-altas").show(),await obtenerAeronaves()}async function obtenerAeronaves(){try{const a=await fetch("/aeronaves/activas",{method:"GET"}),e=await a.json();return!e.length>0&&SwalToast("warning","No hay Programas disponibles.",2500),e}catch(a){console.error(a),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function obtenerPreferencia(){try{const a=await fetch("tarifa/tipo",{method:"GET"}),e=await a.json();return!e.length>0&&SwalToast("warning","No hay Tarifas disponibles.",2500),e}catch(a){console.error(a),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function traerTarifas(){try{const a=await fetch("obtener/tarifas",{method:"GET"}),e=await a.json();let r=verificarArray(e);gridApi.setGridOption("rowData",r)}catch(a){console.error(a),SwalToast("warning","Error al obtener los datos",2500)}}async function crearTarifa(){const a=$("#aeronave_id").val(),e=$("#preferencia_id").val(),r=sinComa($("#costo_mx").val()),o=sinComa($("#costo_usd").val());try{const t=new FormData;t.append("aeronave_id",a),t.append("tarifa_id",e),t.append("costo_mx",r),t.append("costo_usd",o);const n=await fetch("crear/tarifa",{method:"POST",body:t}),i=await n.json();1==i.exito?(SwalLoad("success","Éxito","Registro Creado Correctamente",!1),setTimeout(()=>{swal.close(),resetForm(),traerTarifas()},1500)):0==i.exito&&SwalLoad("error","Error en la Transacción",i.errorSMS,!0),i.alertas&&SwalToast("warning",i.alertas.error,2500)}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function actualizarTarifa(){const a=$("#costo_id").val(),e=$("#aeronave_id").val(),r=$("#preferencia_id").val(),o=sinComa($("#costo_mx").val()),t=sinComa($("#costo_usd").val());try{const n=new FormData;n.append("costo_id",a),n.append("aeronave_id",e),n.append("tarifa_id",r),n.append("costo_mx",o),n.append("costo_usd",t);const i=await fetch("actualizar/tarifa",{method:"POST",body:n}),c=await i.json();1==c.exito?(SwalLoad("success","Éxito","Registro Actualizado Correctamente",!1),setTimeout(()=>{swal.close(),resetForm(),traerTarifas()},1500)):0==c.exito&&SwalLoad("error","Error en la Transacción",c.errorSMS,!0),c.alertas&&SwalToast("warning",c.alertas.error,2500)}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}$((function(){asignarEventos(),inicializarPagina(),configurarBotones()}));
//# sourceMappingURL=tarifaCostos.js.map
