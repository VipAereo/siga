let gridOptions;function asignarEventos(){document.addEventListener("keydown",e=>{"Escape"===e.key&&cerrarVentana(".contenedor-altas",["#formAltas"])})}function configurarBotones(){$(".contenedor-altas").hide(),$("#crear-rol").click(mostrarContenedorAltas),$("#btnCancel").click(e=>{limpiarForm("#formAltas"),$(".contenedor-altas").hide()}),$("#btnGuardar").click(e=>{validateInputs($("#formAltas"))&&(""==$("#rol_id").val()?crearRol():actualizarRol())})}function inicializarPagina(){iniciarTabla("",[{headerName:"id",field:"rol_id",width:60},{headerName:"Nombre Rol",field:"nombre_rol",width:200},{headerName:"Descripción",field:"descripcion",width:200},{headerName:"Estatus",field:"estatus",width:100},{headerName:"Fecha Creacion",field:"fecha_creacion",width:180},{headerName:"Acción",cellRenderer:function(e){const a=document.createElement("I");a.className="fa-regular fa-pen-to-square btn btn-editar",a.title="Editar",a.addEventListener("click",(async function(){await mostrarContenedorAltas(),$("#rol_id").val(e.data.rol_id),$("#nombre_rol").val(e.data.nombre_rol),$("#descripcion").val(e.data.descripcion),$("#estatus").val(e.data.estatus)}));const r=document.createElement("div");return r.classList="btn-cont centrado",r.appendChild(a),r},width:150,headerClass:"txt-center",cellClass:"custom-action-cell",filter:!1}],"#myGrid"),traerRoles()}function onQuickFilterChanged(){var e=document.getElementById("quickFilter").value;gridApi.updateGridOptions({quickFilterText:e})}async function traerRoles(){try{const e=await fetch("allRoles",{method:"GET"}),a=await e.json();let r=verificarArray(a);gridApi.setGridOption("rowData",r)}catch(e){console.error(e),SwalToast("warning","Error al obtener los usuarios",2500)}}async function mostrarContenedorAltas(){$(".contenedor-altas").show()}async function generarCrearUser(e,a){Swal.fire({title:e+" Rol",html:'\n            <div class="user-contenedor">\n                <div class="alertas"></div>\n                <div class="form-dsg">\n\n                    <div class="form-group">\n                        <input type="text" id="nombre_rol" placeholder="">\n                        <label for="nombre_rol">Nombre Rol:</label>\n                    </div>\n                    <div class="form-group">\n                        <input type="text" id="descripcion" placeholder="">\n                        <label for="descripcion">Descripción:</label>\n                    </div>\n\n                    <div class="form-group">\n                        <select name="estatus" id="estatus" >\n                            <option value="Activo">Activo</option>\n                            <option value="Inactivo">Inactivo</option>\n                            \n                        </select>\n                        <label for="estatus">Estatus:</label>\n                    </div>\n\n                </div>\n            </div>\n            ',showDenyButton:!0,confirmButtonText:"Guardar",denyButtonText:"Cancelar",customClass:"swalTitle crear-usuario",allowOutsideClick:!1,preConfirm:()=>{const e=$("#nombre_rol").val(),a=$("#descripcion").val(),r=document.querySelector(".alertas");r.innerHTML="";let o=[];return e||o.push("Nombre Requerido"),a||o.push("Descripción Requerida"),o.length>0?(o.forEach(e=>{r.innerHTML+=`<div class="alerta alerta_error" role="alert">${e}</div>`}),!1):{nombreRol:e,descripcion:a}},didOpen:async()=>{"Actualizar"==e&&($("#nombre_rol").val(a.nombre_rol),$("#descripcion").val(a.descripcion),$("#estatus").val(a.estatus))}}).then(async r=>{if(console.log(r),"Crear"==e){if(r.isConfirmed){const e=$("#nombre_rol").val(),a=$("#descripcion").val(),r=$("#estatus").val(),o=new FormData;o.append("nombre_rol",e),o.append("descripcion",a),o.append("estatus",r);try{const e=await fetch("crear/rol",{method:"POST",body:o}),a=await e.json();1==a.exito&&(SwalLoad("success","Éxito","Rol Creado Correctamente",!1),setTimeout(()=>{swal.close(),traerRoles()},1500)),a.alertas&&SwalToast("warning",a.alertas.error,2500)}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}}else if("Actualizar"==e){if(r.isConfirmed){const e=$("#nombre_rol").val(),r=$("#descripcion").val(),o=$("#estatus").val(),t=new FormData;t.append("rol_id",a.rol_id),t.append("nombre_rol",e),t.append("descripcion",r),t.append("estatus",o),t.append("fecha_creacion",a.fecha_creacion);try{const e=await fetch("actualizar/rol",{method:"POST",body:t}),a=await e.json();1==a.exito&&(SwalLoad("success","Éxito","Rol Actualizado Correctamente",!1),setTimeout(()=>{swal.close(),traerRoles()},1500)),a.alertas&&SwalToast("warning",a.alertas.error,2500)}catch(e){console.error(e),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}}else SwalToast("warning","Error, tipo de acción no definida.",2500)})}async function crearRol(){const e=$("#nombre_rol").val(),a=$("#descripcion").val(),r=$("#estatus").val();try{const o=new FormData;o.append("nombre_rol",e),o.append("descripcion",a),o.append("estatus",r);const t=await fetch("crear/rol",{method:"POST",body:o}),n=await t.json();1==n.exito?(SwalLoad("success","Éxito","Rol Creado Correctamente",!1),setTimeout(()=>{swal.close(),cerrarVentana(".contenedor-altas",["#formAltas"]),traerRoles()},1500)):0==n.exito&&SwalLoad("error","Error en la Transacción",n.errorSMS,!0),n.alertas&&(SwalToast("warning",n.alertas.error,2500),cerrarVentana(".contenedor-altas",["#formAltas"]))}catch(e){console.error(e),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function actualizarRol(){const e=$("#rol_id").val(),a=$("#nombre_rol").val(),r=$("#descripcion").val(),o=$("#estatus").val();try{const t=new FormData;t.append("rol_id",e),t.append("nombre_rol",a),t.append("descripcion",r),t.append("estatus",o);const n=await fetch("actualizar/rol",{method:"POST",body:t}),i=await n.json();1==i.exito?(SwalLoad("success","Éxito","Rol Actualizado Correctamente",!1),setTimeout(()=>{swal.close(),cerrarVentana(".contenedor-altas",["#formAltas"]),traerRoles()},1500)):0==i.exito&&SwalLoad("error","Error en la Transacción",i.errorSMS,!0),i.alertas&&SwalToast("warning",i.alertas.error,2500)}catch(e){console.error(e),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}$((function(){asignarEventos(),inicializarPagina(),configurarBotones()}));
//# sourceMappingURL=roles.js.map
