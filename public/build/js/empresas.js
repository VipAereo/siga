let gridOptions,currentStep=1;function asignarEventos(){document.addEventListener("keydown",a=>{"Escape"===a.key&&resetearFormularioEmpresas()})}function configurarBotones(){$(".contenedor-altas").hide(),$("#crear-empresa").click(mostrarContenedorAltas),$(".btn-next").click((function(a){let e;a.preventDefault(),1==currentStep&&(e=validateInputs($("#empresa_formulario-empresa"))),2==currentStep&&(e=validateInputs($("#empresa_formulario-contacto"))),e&&($("#paso"+currentStep).hide(),currentStep++,$("#paso"+currentStep).show(),updateActiveClass())})),$(".btnCancel").click(a=>{currentStep=1,resetearFormularioEmpresas()}),$(".btn-prev").click((function(a){a.preventDefault(),$("#paso"+currentStep).hide(),currentStep--,$("#paso"+currentStep).show(),updateRemoveClass()})),$("#btnGuardar").click(a=>{validateInputs($("#empresa_formulario-fiscal"))&&(""==$("#empresa_id").val()?crearEmpresa():actualizarEmpresa())}),updateActiveClass(),updateRemoveClass()}function inicializarPagina(){iniciarTabla("",[{headerName:"id",field:"empresa_id",width:60},{headerName:"Siglas",field:"siglas_empresa",width:100},{headerName:"Nombre",field:"nombre",width:150},{headerName:"Teléfono",field:"telefono",width:120},{headerName:"Email",field:"email",width:120},{headerName:"Contacto",field:"contacto_principal",width:150},{headerName:"Estatus",field:"estatus",width:100},{headerName:"Razón Social",field:"razon_social",width:120},{headerName:"Dirección",field:"calle",width:120},{headerName:"Acción",cellRenderer:function(a){const e=document.createElement("I");e.className="fa-regular fa-pen-to-square btn btn-editar",e.title="Editar",e.addEventListener("click",(async function(){await mostrarContenedorAltas(),$("#empresa_id").val(a.data.empresa_id),$("#nombre").val(a.data.nombre),$("#siglas_empresa").val(a.data.siglas_empresa),$("#telefono").val(a.data.telefono),$("#email").val(a.data.email),$("#sitio_web").val(a.data.sitio_web),$("#contacto_principal").val(a.data.contacto_principal),$("#calle").val(a.data.calle),$("#num_ext").val(a.data.num_ext),$("#num_int").val(a.data.num_int),$("#ciudad").val(a.data.ciudad),$("#estado").val(a.data.estado),$("#municipio").val(a.data.municipio),$("#codigo_postal").val(a.data.codigo_postal),$("#colonia").val(a.data.colonia),$("#pais").val(a.data.pais),$("#rfc").val(a.data.rfc),$("#razon_social").val(a.data.razon_social),$("#regimen_fiscal").val(a.data.regimen_fiscal),$("#giro_comercial").val(a.data.giro_comercial),$("#estatus").val(a.data.estatus)}));const o=document.createElement("div");return o.classList="btn-cont centrado",o.appendChild(e),o},width:150,headerClass:"txt-center",cellClass:"custom-action-cell",filter:!1}],"#myGrid"),traerEmpresas()}async function mostrarContenedorAltas(){$(".contenedor-altas").show()}async function traerEmpresas(){try{const a=await fetch("allEmpresas",{method:"GET"}),e=await a.json();let o=verificarArray(e);gridApi.setGridOption("rowData",o)}catch(a){console.error(a),SwalToast("warning","Error al obtener los usuarios",2500)}}function updateActiveClass(){$(".empleado_pasos p").removeClass("pasoActivo"),1===currentStep?($(".paso1 p").addClass("pasoActivo"),$(".btn-guardar").addClass("hidden"),$(".btn-next").removeClass("hidden")):2===currentStep?($(".paso2 p").addClass("pasoActivo"),$(".paso1 p").addClass("circle-check"),$(".btn-prev").removeClass("invisible")):3===currentStep&&($(".paso3 p").addClass("pasoActivo"),$(".paso2 p").addClass("circle-check"),$(".btn-next").addClass("hidden"),$(".btn-guardar").removeClass("hidden"))}function updateRemoveClass(){$(".empleado_pasos p").removeClass("circle-check"),1===currentStep?($(".paso1 p").addClass("pasoActivo"),$(".paso2 p").removeClass("pasoActivo"),$(".btn-prev").addClass("invisible")):2===currentStep&&($(".paso1 p").addClass("circle-check"),$(".paso2 p").addClass("pasoActivo"),$(".paso3 p").removeClass("pasoActivo"),$(".btn-next").removeClass("hidden"),$(".btn-guardar").addClass("hidden"))}function resetearFormularioEmpresas(){cerrarVentana(".contenedor-altas",["#empresa_formulario-empresa","#empresa_formulario-contacto","#empresa_formulario-fiscal"]),$(".altas_pasos p").removeClass("pasoActivo circle-check"),$("#paso1").show(),$("#paso2").hide(),$("#paso3").hide(),$(".paso1 p").addClass("pasoActivo"),currentStep=1,updateRemoveClass(),updateActiveClass()}async function crearEmpresa(){const a=$("#nombre").val(),e=$("#siglas_empresa").val(),o=$("#telefono").val(),r=$("#email").val(),t=$("#sitio_web").val(),s=$("#contacto_principal").val(),i=$("#calle").val(),n=$("#num_ext").val(),l=$("#num_int").val(),c=$("#ciudad").val(),p=$("#estado").val(),d=$("#municipio").val(),m=$("#codigo_postal").val(),u=$("#colonia").val(),v=$("#pais").val(),_=$("#rfc").val(),f=$("#razon_social").val(),h=$("#regimen_fiscal").val(),w=$("#giro_comercial").val(),C=$("#estatus").val();try{const $=new FormData;$.append("nombre",a),$.append("siglas_empresa",e),$.append("telefono",o),$.append("email",r),$.append("sitio_web",t),$.append("contacto_principal",s),$.append("calle",i),$.append("num_ext",n),$.append("num_int",l),$.append("ciudad",c),$.append("estado",p),$.append("municipio",d),$.append("codigo_postal",m),$.append("colonia",u),$.append("pais",v),$.append("rfc",_),$.append("razon_social",f),$.append("regimen_fiscal",h),$.append("giro_comercial",w),$.append("estatus",C);const g=await fetch("crear/empresa",{method:"POST",body:$}),b=await g.json();console.log(b),1==b.exito?(SwalLoad("success","Éxito","Registro Creado Correctamente",!1),setTimeout(()=>{swal.close(),resetearFormularioEmpresas(),traerEmpresas()},1500)):0==b.exito&&SwalLoad("error","Error en la Transacción",b.errorSMS,!0),b.alertas&&SwalToast("warning",b.alertas.error,2500)}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function actualizarEmpresa(){const a=$("#empresa_id").val(),e=$("#nombre").val(),o=$("#siglas_empresa").val(),r=$("#telefono").val(),t=$("#email").val(),s=$("#sitio_web").val(),i=$("#contacto_principal").val(),n=$("#calle").val(),l=$("#num_ext").val(),c=$("#num_int").val(),p=$("#ciudad").val(),d=$("#estado").val(),m=$("#municipio").val(),u=$("#codigo_postal").val(),v=$("#colonia").val(),_=$("#pais").val(),f=$("#rfc").val(),h=$("#razon_social").val(),w=$("#regimen_fiscal").val(),C=$("#giro_comercial").val(),g=$("#estatus").val();try{const $=new FormData;$.append("empresa_id",a),$.append("nombre",e),$.append("siglas_empresa",o),$.append("telefono",r),$.append("email",t),$.append("sitio_web",s),$.append("contacto_principal",i),$.append("calle",n),$.append("num_ext",l),$.append("num_int",c),$.append("ciudad",p),$.append("estado",d),$.append("municipio",m),$.append("codigo_postal",u),$.append("colonia",v),$.append("pais",_),$.append("rfc",f),$.append("razon_social",h),$.append("regimen_fiscal",w),$.append("giro_comercial",C),$.append("estatus",g);const b=await fetch("actualizar/empresa",{method:"POST",body:$}),S=await b.json();1==S.exito?(SwalLoad("success","Éxito","Registro Actualizado Correctamente",!1),setTimeout(()=>{swal.close(),resetearFormularioEmpresas(),traerEmpresas()},1500)):0==S.exito&&SwalLoad("error","Error en la Transacción",S.errorSMS,!0),S.alertas&&SwalToast("warning",S.alertas.error,2500)}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}$((function(){asignarEventos(),inicializarPagina(),configurarBotones()}));
//# sourceMappingURL=empresas.js.map
