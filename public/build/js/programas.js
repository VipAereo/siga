let gridOptions;function asignarEventos(){$(".menuSearch").hide(),document.addEventListener("keydown",a=>{if("Escape"===a.key){document.querySelector(".contenedorKey")?resetLista("#listKey"):cerrarVentana(".contenedor-altas",["#formAltas"])}}),document.getElementById("padre").addEventListener("mousedown",(async function(a){a.preventDefault(),$(".menuSearch").show(),$(".inMenuSrch").focus();let r=await obtenerMenu();verificarPrograma(await mostrarListaSearch(r,".menuSearch","programa_id","nombre"))})),$(".inMenuSrch").keydown(async a=>{if(114===a.keyCode){a.preventDefault();const e=await obtenerMenu(),n=["programa_id","nombre","nivel"];let t=await createDataTable(e,n,"600","400","Menú");if(console.log(t),t){var r=document.getElementById("padre");r.children[0].value=t[0],r.children[0].text=t[1],await verificarPrograma(t)}}})}function configurarBotones(){$(".contenedor-altas").hide(),$("#crear-programa").click(mostrarContenedorAltas),$("#btnCancel").click(a=>{cerrarVentana(".contenedor-altas",["#formAltas"]),$(".contenedor-altas").hide()}),$("#btnGuardar").click(a=>{validateInputs($("#formAltas"))&&(""==$("#programa_id").val()?crearPrograma():actualizaPrograma())})}function inicializarPagina(){iniciarTabla("",[{headerName:"id",field:"programa_id",width:60},{headerName:"Nombre",field:"nombre",width:150},{headerName:"Padre",field:"nombre_padre",width:150},{headerName:"Nivel",field:"nivel",width:80},{headerName:"Ruta",field:"ruta",width:150},{headerName:"Fecha de Creación",field:"fecha_creacion",width:140},{headerName:"Acción",cellRenderer:function(a){const r=document.createElement("I");r.className="fa-regular fa-pen-to-square btn btn-editar",r.title="Editar",r.addEventListener("click",(async function(){await mostrarContenedorAltas(),$("#programa_id").val(a.data.programa_id),$("#nombre").val(a.data.nombre),$("#ruta").val(a.data.ruta),$("#nivel").val(a.data.nivel),$("#padre option").val(a.data.padre),$("#padre option").text(a.data.nombre_padre)}));const e=document.createElement("div");return e.classList="btn-cont centrado",e.appendChild(r),e},width:150,headerClass:"txt-center",cellClass:"custom-action-cell",filter:!1}],"#myGrid"),traerProgramas()}async function traerProgramas(){try{const a=await fetch("allProgramas",{method:"GET"}),r=await a.json();let e=verificarArray(r);gridApi.setGridOption("rowData",e)}catch(a){console.error(a),SwalToast("warning","Error al obtener los usuarios",2500)}}async function mostrarContenedorAltas(){$(".contenedor-altas").show()}async function obtenerMenu(){try{const a=await fetch("/allProgramas",{method:"GET"}),r=await a.json();return!r.length>0&&SwalToast("warning","No hay Programas disponibles.",2500),r}catch(a){console.error(a),SwalLoad("error","Ocurrio Un Error","Conección Perdida a BD.",!1)}}async function crearPrograma(){const a=$("#nombre").val(),r=$("#ruta").val(),e=$("#padre").val(),n=$("#nivel").val();try{const t=new FormData;t.append("nombre",a),t.append("ruta",r),t.append("padre",e),t.append("nivel",n);const o=await fetch("crear/programa",{method:"POST",body:t}),i=await o.json();1==i.exito?(SwalLoad("success","Éxito","Programa Creado Correctamente",!1),setTimeout(()=>{swal.close(),cerrarVentana(".contenedor-altas",["#formAltas"]),traerProgramas()},1500)):0==i.exito&&SwalLoad("error","Error en la Transacción",i.errorSMS,!0),i.alertas&&(SwalToast("warning",i.alertas.error,2500),cerrarVentana(".contenedor-altas",["#formAltas"]))}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function actualizaPrograma(){const a=$("#programa_id").val(),r=$("#nombre").val(),e=$("#ruta").val(),n=$("#padre").val(),t=$("#nivel").val();try{const o=new FormData;o.append("programa_id",a),o.append("nombre",r),o.append("ruta",e),o.append("padre",n),o.append("nivel",t);const i=await fetch("actualizar/programa",{method:"POST",body:o}),c=await i.json();1==c.exito?(SwalLoad("success","Éxito","Programa Actualizado Correctamente",!1),setTimeout(()=>{swal.close(),cerrarVentana(".contenedor-altas",["#formAltas"]),traerProgramas()},1500)):0==c.exito&&SwalLoad("error","Error en la Transacción",c.errorSMS,!0),c.alertas&&SwalToast("warning",c.alertas.error,2500)}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}async function verificarPrograma(a){progVerificar(),$("#nivel").val(Number(a.nivel)?parseInt(a.nivel)+1:1)}async function progVerificar(){let a=$("#padre").val();try{const r=new FormData;r.append("progId",a);const e=await fetch("verificar/programa",{method:"POST",body:r});1==await e.json()&&(SwalToast("warning","El Menú ya tiene una ruta.",2500),$("#padre").val(""))}catch(a){console.error(a),SwalLoad("error","Error en la Conexión","Comunicate con el Administrador",!1)}}$((function(){asignarEventos(),inicializarPagina(),configurarBotones()}));
//# sourceMappingURL=programas.js.map
